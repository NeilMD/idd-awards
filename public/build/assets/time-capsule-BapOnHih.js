document.querySelectorAll(".filter-btn").forEach(e=>{e.addEventListener("click",function(){document.querySelectorAll(".filter-btn").forEach(n=>{n.classList.remove("active")}),this.classList.add("active");const t=this.getAttribute("data-filter");document.querySelectorAll(".section").forEach(n=>{n.classList.remove("active-section")}),document.getElementById(t).classList.add("active-section")})});const s=document.getElementById("submission-form"),k=document.getElementById("memory-image"),L=document.getElementById("image-preview"),w=document.getElementById("preview-img"),U=document.getElementById("remove-image"),T=document.querySelector(".gallery-grid");document.querySelectorAll(".filter-btn");const v=document.getElementById("submit-modal"),u=document.getElementById("memory-modal"),F=document.getElementById("modal-image"),R=document.getElementById("modal-category"),j=document.getElementById("modal-title"),H=document.getElementById("modal-submitter"),$=document.getElementById("modal-description"),O=document.querySelectorAll(".close-modal"),m=document.getElementById("submit-memory"),B=document.getElementById("category"),g=document.getElementById("link-container"),b=document.getElementById("link"),_=document.getElementById("gallery-section"),G=window.location.origin+window.location.pathname,N=G+"/load-more";function X(){z()}function x(){B.value==="ux"||B.value==="web"?g.style.display="block":g.style.display="none"}document.getElementById("all").addEventListener("click",()=>y("all"));document.getElementById("graphic").addEventListener("click",()=>y("graphic"));document.getElementById("ux").addEventListener("click",()=>y("ux"));document.getElementById("web").addEventListener("click",()=>y("web"));function z(){k.addEventListener("change",K),U.addEventListener("click",S),s.addEventListener("submit",W),O.forEach(e=>{e.addEventListener("click",()=>{u.style.display="none",v.style.display="none"})}),window.addEventListener("click",e=>{e.target===u&&(u.style.display="none",v.style.display="none")})}function K(e){const t=e.target.files[0];if(t){const n=new FileReader;n.onload=function(o){if(e.target.files[0].size>2097152){alert("File should be less than 2mb."),e.target.value="";return}else w.src=o.target.result,L.style.display="block"},n.readAsDataURL(t)}}function S(){k.value="",w.src="#",L.style.display="none"}function V(){document.getElementById("submit-title").textContent="Notes",document.getElementById("modal-notes").innerHTML=`<span>
              If you have submitted before, you're previous submission will be overwritten.
            </span>
            <br/>
            <br/>
            <span>
              Please wait 1-2mins for the verification email to arrived. It may arrived on your junk/spam folder! 
            </span>
            <br/>
            <span>
              <small>(dev notes: we dont have smtp server, sorry ðŸ™‡)</small>
            </span>`}function W(e){e.preventDefault(),console.log("Prevent Default"),m.classList.add("button-disabled"),V(),v.style.display="block";const t=document.getElementById("submitter-name").value,n=document.getElementById("memory-title").value,o=document.getElementById("memory-description").value,r=document.getElementById("memory-image").files[0],c=document.getElementById("email").value,a=document.getElementById("category").value,d=document.getElementById("link").value;let p=[];if(!r){alert("Please select an image to upload");return}if(a==="ux"||a==="web"?(g.style.display="block",b.required=!0):(g.style.display="none",b.required=!1),(a==="ux"||a==="web")&&!b.value&&p.push("Please provide a valid link (URL) for UX or Web category."),!s.checkValidity()){s.querySelectorAll(":invalid").forEach(l=>{p.push(`${l.name} is invalid.`)}),alert(`Error: 
`+p.join(`
`)),m.classList.remove("button-disabled");return}const M=this.getAttribute("data-attr-submit"),A=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),E=new FileReader;E.onloadend=function(f){f.target.result,new Date().getTime();const l=new FormData;l.append("name",t),l.append("design_title",n),l.append("design_description",o),l.append("image",r),l.append("email",c),l.append("link",d),l.append("design_category",a),fetch(M,{method:"POST",headers:{"X-CSRF-TOKEN":A},body:l}).then(i=>i.ok?i.json():i.json().then(I=>{let h="";for(const[Q,P]of Object.entries(I.errors))P.forEach(D=>{h+="<br/><span>"+D+"</span><br/>"});throw console.error("Error details:",I),h})).then(i=>{i.success&&(s.reset(),S()),m.classList.remove("button-disabled")}).catch(i=>{m.classList.remove("button-disabled"),document.getElementById("submit-title").textContent="Submission Failed: Unable to Submit Design",document.getElementById("modal-notes").innerHTML=i})},E.readAsDataURL(r)}function q(e){F.src=e.querySelector(".gallery-image").src,j.textContent=e.querySelector(".gallery-title").textContent,R.textContent=e.querySelector(".gallery-category span").textContent,H.textContent=`Submitted by ${e.querySelector(".gallery-submitter").textContent.substring(3)}`,$.innerHTML=`${e.querySelector(".gallery-description").textContent} Check out the link <a href='${e.getAttribute("data-attr-link")}' target="_blank">here</a>.`,u.style.display="block"}X();const J=document.querySelectorAll(".gallery-item");J.forEach(e=>{e.addEventListener("click",t=>q(e))});document.getElementById("category").addEventListener("change",x);document.addEventListener("DOMContentLoaded",function(){x(),s.reset();const e=document.getElementById("load-more");new IntersectionObserver(n=>{if(n[0].isIntersecting){let r=document.getElementById("next-page-url").value;r&&C(r)}}).observe(e)});function C(e){let t=document.getElementById("next-page-category").value,n=e.includes("?page")?e+`&category=${t}`:e+`?category=${t}`;fetch(n).then(o=>o.json()).then(o=>{let r=document.createElement("div");r.innerHTML=o.submissionsHtml.trim();const c=r.querySelectorAll(".gallery-item");c.forEach(d=>{d.addEventListener("click",()=>q(d))}),_.append(...c);let a=document.querySelector("#next-page-url");a.value=o.nextPageUrl}).catch(o=>console.error("Error fetching more data:",o))}function y(e){console.log("tigres"),document.getElementById("next-page-url");let t=document.getElementById("next-page-category");t.value=e,T.innerHTML="",C(N)}
