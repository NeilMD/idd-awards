document.querySelectorAll(".filter-btn").forEach(e=>{console.log(`button ${e}`),e.addEventListener("click",function(){const t=this.getAttribute("data-filter");document.querySelectorAll(".tab-content").forEach(n=>{n.classList.remove("active-section")}),document.getElementById(t).classList.add("active-section")})});const c=document.getElementById("submission-form"),d=document.getElementById("memory-image"),m=document.getElementById("image-preview"),u=document.getElementById("preview-img"),h=document.getElementById("remove-image"),S=document.querySelector(".gallery-grid");document.querySelectorAll(".filter-btn");const r=document.getElementById("memory-modal"),B=document.getElementById("modal-image"),L=document.getElementById("modal-title"),w=document.getElementById("modal-submitter"),q=document.getElementById("modal-description"),k=document.querySelector(".close-modal");function A(){D()}function D(){d.addEventListener("change",C),h.addEventListener("click",g),c.addEventListener("submit",F),k.addEventListener("click",()=>{r.style.display="none"}),window.addEventListener("click",e=>{e.target===r&&(r.style.display="none")})}function C(e){const t=e.target.files[0];if(t){const n=new FileReader;n.onload=function(i){u.src=i.target.result,m.style.display="block"},n.readAsDataURL(t)}}function g(){d.value="",u.src="#",m.style.display="none"}function F(e){console.log("handleSubmission"),e.preventDefault();const t=document.getElementById("submitter-name").value,n=document.getElementById("memory-title").value,i=document.getElementById("memory-description").value,a=document.getElementById("memory-image").files[0];if(!a){alert("Please select an image to upload");return}const p=this.getAttribute("data-attr-submit"),E=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),s=new FileReader;s.onloadend=function(f){const b=f.target.result,v={id:Date.now(),name:t,title:n,description:i,imageUrl:b,timestamp:new Date().getTime()},l=new FormData;l.append("name",t),l.append("design_title",n),l.append("design_description",i),l.append("image",a),fetch(p,{method:"POST",headers:{"X-CSRF-TOKEN":E},body:l}).then(o=>o.json()).then(o=>{if(!o.success)console.error("Error:",error),alert("Error: occured Submitting Design");else{c.reset(),g();const I=M(v);S.insertAdjacentElement("afterbegin",I),alert("Your design has been added to the time capsule!")}}).catch(o=>{console.error("Error:",o),alert("Error: occured Submitting Design")})},s.readAsDataURL(a)}function M(e){const t=document.createElement("div");return t.className="gallery-item",t.dataset.id=e.id,t.innerHTML=`
        <div class="gallery-image-container">
            <img src="${e.imageUrl}" alt="${e.title}" class="gallery-image">
        </div>
        <div class="gallery-info">
            <h3 class="gallery-title">${e.title}</h3>
            <p class="gallery-submitter">By ${e.name}</p>
            <p class="gallery-description">${e.description}</p>
        </div>
    `,t.addEventListener("click",()=>{y(e)}),t}function y(e){B.src=e.imageUrl,L.textContent=e.title,w.textContent=`Submitted by ${e.name}`,q.textContent=e.description,r.style.display="block"}A();const U=document.querySelectorAll(".gallery-item");U.forEach(e=>{e.addEventListener("click",t=>{let n={imageUrl:e.querySelector(".gallery-image").src,title:e.querySelector(".gallery-title").textContent,name:e.querySelector(".gallery-submitter").textContent.substring(3),description:e.querySelector(".gallery-description").textContent};y(n)})});document.getElementById("memory-image").addEventListener("change",e=>{e.target.files[0].size>2097152&&(alert("File should be less than 2mb."),e.target.value="")});
