document.querySelectorAll(".filter-btn").forEach(e=>{e.addEventListener("click",function(){document.querySelectorAll(".filter-btn").forEach(n=>{n.classList.remove("active")}),this.classList.add("active");const t=this.getAttribute("data-filter");document.querySelectorAll(".section").forEach(n=>{n.classList.remove("active-section")}),document.getElementById(t).classList.add("active-section")})});const g=document.getElementById("submission-form"),I=document.getElementById("memory-image"),h=document.getElementById("image-preview"),B=document.getElementById("preview-img"),P=document.getElementById("remove-image"),U=document.querySelector(".gallery-grid");document.querySelectorAll(".filter-btn");const s=document.getElementById("submit-modal"),u=document.getElementById("memory-modal"),A=document.getElementById("modal-image"),D=document.getElementById("modal-category"),T=document.getElementById("modal-title"),F=document.getElementById("modal-submitter"),R=document.getElementById("modal-description"),H=document.querySelectorAll(".close-modal"),d=document.getElementById("submit-memory");document.getElementById("category");const E=document.getElementById("link-container"),b=document.getElementById("link"),j=document.getElementById("gallery-section"),O=window.location.origin+window.location.pathname,_=O+"/load-more";function $(){G()}document.getElementById("all").addEventListener("click",()=>y("all"));document.getElementById("graphic").addEventListener("click",()=>y("graphic"));document.getElementById("ux").addEventListener("click",()=>y("ux"));document.getElementById("web").addEventListener("click",()=>y("web"));function G(){I.addEventListener("change",N),P.addEventListener("click",k),g.addEventListener("submit",z),H.forEach(e=>{e.addEventListener("click",()=>{u.style.display="none",s.style.display="none"})}),window.addEventListener("click",e=>{e.target===u&&(u.style.display="none"),e.target===s&&(s.style.display="none")})}function N(e){const t=e.target.files[0];if(t){const n=new FileReader;n.onload=function(o){if(e.target.files[0].size>2097152){alert("File should be less than 2mb."),e.target.value="";return}else B.src=o.target.result,h.style.display="block"},n.readAsDataURL(t)}}function k(){I.value="",B.src="#",h.style.display="none"}function X(){document.getElementById("submit-title").textContent="Notes",document.getElementById("modal-notes").innerHTML=`<span><strong>Before your submission is posted, please verify it via the email you will receive.</strong></span>
            <span><strong>If you've submitted previously, your prior submission will be replaced.</strong></span>
            <br/>
            <br/>
            <span>
              Please wait <a href="https://outlook.office.com/mail/" class="note-time" target="_blank">3-5mins</a> for the verification email to arrived. It may arrived on your junk/spam folder! 
            </span>
            <br/>
            <span>
              <small>(dev notes: Please be patient, we dont have dedicated email server. Sorry! ðŸ™‡)</small>
            </span>`}function z(e){e.preventDefault(),console.log("Prevent Default"),d.classList.add("button-disabled"),X(),s.style.display="block";const t=document.getElementById("submitter-name").value,n=document.getElementById("memory-title").value,o=document.getElementById("memory-description").value,l=document.getElementById("memory-image").files[0],c=document.getElementById("email").value,r=document.getElementById("category").value,m=document.getElementById("link").value;if(!l){alert("Please select an image to upload");return}if(r==="ux"||r==="web"?(E.style.display="block",b.required=!0):(E.style.display="none",b.required=!1),(r==="ux"||r==="web")&&b.value,!g.checkValidity()){s.style.display="block",d.classList.remove("button-disabled"),document.getElementById("submit-title").textContent="Submission Failed: Unable to Submit Design",document.getElementById("modal-notes").innerHTML="<br/><br/><span>Please provide a valid link (URL) for UX or Web category.</span>",d.classList.remove("button-disabled");return}const S=this.getAttribute("data-attr-submit"),x=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),p=new FileReader;p.onloadend=function(q){q.target.result,new Date().getTime();const a=new FormData;a.append("name",t),a.append("design_title",n),a.append("design_description",o),a.append("image",l),a.append("email",c),a.append("link",m),a.append("design_category",r),fetch(S,{method:"POST",headers:{"X-CSRF-TOKEN":x},body:a}).then(i=>i.ok?i.json():i.json().then(f=>{let v="";for(const[V,C]of Object.entries(f.errors))C.forEach(M=>{v+="<br/><span>"+M+"</span><br/>"});throw console.error("Error details:",f),v})).then(i=>{i.success&&(g.reset(),k()),d.classList.remove("button-disabled")}).catch(i=>{s.style.display="block",d.classList.remove("button-disabled"),document.getElementById("submit-title").textContent="Submission Failed: Unable to Submit Design",document.getElementById("modal-notes").innerHTML=i})},p.readAsDataURL(l)}function L(e){A.src=e.querySelector(".gallery-image").src,T.textContent=e.querySelector(".gallery-title").textContent,D.textContent=e.querySelector(".gallery-category span").textContent,F.textContent=`Submitted by ${e.querySelector(".gallery-submitter").textContent.substring(3)}`;let t=e.querySelector(".gallery-description").textContent,n=e.getAttribute("data-attr-link");R.innerHTML=n?`${t} <br/> <br/> Check out the link <a href='${n}' target="_blank">here</a>.`:t,u.style.display="block"}$();const K=document.querySelectorAll(".gallery-item");K.forEach(e=>{e.addEventListener("click",t=>L(e))});document.addEventListener("DOMContentLoaded",function(){g.reset();const e=document.getElementById("load-more");new IntersectionObserver(n=>{if(n[0].isIntersecting){let l=document.getElementById("next-page-url").value;l&&w(l)}}).observe(e)});function w(e){let t=document.getElementById("next-page-category").value,n=e.includes("?page")?e+`&category=${t}`:e+`?category=${t}`;fetch(n).then(o=>o.json()).then(o=>{let l=document.createElement("div");l.innerHTML=o.submissionsHtml.trim();const c=l.querySelectorAll(".gallery-item");c.forEach(m=>{m.addEventListener("click",()=>L(m))}),j.append(...c);let r=document.querySelector("#next-page-url");r.value=o.nextPageUrl}).catch(o=>console.error("Error fetching more data:",o))}function y(e){document.getElementById("next-page-url");let t=document.getElementById("next-page-category");t.value=e,U.innerHTML="",w(_)}
