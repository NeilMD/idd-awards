const u=document.getElementById("submission-form"),g=document.getElementById("memory-image"),y=document.getElementById("image-preview"),p=document.getElementById("preview-img"),h=document.getElementById("remove-image"),c=document.getElementById("gallery-grid"),m=document.querySelectorAll(".filter-btn"),o=document.getElementById("memory-modal"),B=document.getElementById("modal-image"),L=document.getElementById("modal-title"),w=document.getElementById("modal-submitter"),S=document.getElementById("modal-description"),k=document.querySelector(".close-modal");let r=[];function D(){M()}function M(){g.addEventListener("change",T),h.addEventListener("click",f),u.addEventListener("submit",F),m.forEach(e=>{e.addEventListener("click",()=>{m.forEach(t=>t.classList.remove("active")),e.classList.add("active"),E(e.dataset.filter)})}),k.addEventListener("click",()=>{o.style.display="none"}),window.addEventListener("click",e=>{e.target===o&&(o.style.display="none")})}function T(e){const t=e.target.files[0];if(t){const n=new FileReader;n.onload=function(i){p.src=i.target.result,y.style.display="block"},n.readAsDataURL(t)}}function f(){g.value="",p.src="#",y.style.display="none"}function F(e){console.log("handleSubmission"),e.preventDefault();const t=document.getElementById("submitter-name").value,n=document.getElementById("memory-title").value,i=document.getElementById("memory-description").value,s=document.getElementById("memory-image").files[0];if(!s){alert("Please select an image to upload");return}const v=this.getAttribute("data-attr-submit"),I=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),d=new FileReader;d.onloadend=function(b){b.target.result,new Date().getTime();const l=new FormData;l.append("name",t),l.append("design_title",n),l.append("design_description",i),l.append("image",s),fetch(v,{method:"POST",headers:{"X-CSRF-TOKEN":I},body:l}).then(a=>a.json()).then(a=>{a.success?(u.reset(),f(),E("all"),alert("Your design has been added to the time capsule!")):(console.error("Error:",error),alert("Error: occured Submitting Design"))}).catch(a=>{console.error("Error:",a),alert("Error: occured Submitting Design")})},d.readAsDataURL(s)}function E(e){c.innerHTML="";let t=[...r];e==="latest"?t=r.filter(n=>n.type==="latest"):e==="featured"&&(t=r.filter(n=>n.type==="featured")),t.forEach(n=>{const i=$(n);c.appendChild(i)})}function $(e){const t=document.createElement("div");return t.className="gallery-item",t.dataset.id=e.id,t.innerHTML=`
        <div class="gallery-image-container">
            <img src="${e.imageUrl}" alt="${e.title}" class="gallery-image">
        </div>
        <div class="gallery-info">
            <h3 class="gallery-title">${e.title}</h3>
            <p class="gallery-submitter">By ${e.name}</p>
            <p class="gallery-description">${e.description}</p>
        </div>
    `,t.addEventListener("click",()=>{A(e)}),t}function A(e){B.src=e.imageUrl,L.textContent=e.title,w.textContent=`Submitted by ${e.name}`,S.textContent=e.description,o.style.display="block"}D();
