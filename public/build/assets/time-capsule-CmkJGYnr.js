document.querySelectorAll(".filter-btn").forEach(e=>{console.log(`button ${e}`),e.addEventListener("click",function(){const t=this.getAttribute("data-filter");document.querySelectorAll(".tab-content").forEach(n=>{n.classList.remove("active-section")}),document.getElementById(t).classList.add("active-section")})});const a=document.getElementById("submission-form"),I=document.getElementById("memory-image"),h=document.getElementById("image-preview"),B=document.getElementById("preview-img"),M=document.getElementById("remove-image"),U=document.querySelector(".gallery-grid");document.querySelectorAll(".filter-btn");const d=document.getElementById("memory-modal"),$=document.getElementById("modal-image"),j=document.getElementById("modal-title"),R=document.getElementById("modal-submitter"),T=document.getElementById("modal-description"),P=document.querySelector(".close-modal"),c=document.getElementById("submit-memory"),E=document.getElementById("category"),m=document.getElementById("link-container"),p=document.getElementById("link");function G(){O()}function k(){E.value==="ux"||E.value==="web"?m.style.display="block":m.style.display="none"}function O(){I.addEventListener("change",_),M.addEventListener("click",L),a.addEventListener("submit",N),P.addEventListener("click",()=>{d.style.display="none"}),window.addEventListener("click",e=>{e.target===d&&(d.style.display="none")})}function _(e){const t=e.target.files[0];if(t){const n=new FileReader;n.onload=function(r){if(e.target.files[0].size>2097152){alert("File should be less than 2mb."),e.target.value="";return}else B.src=r.target.result,h.style.display="block"},n.readAsDataURL(t)}}function L(){I.value="",B.src="#",h.style.display="none"}function N(e){c.classList.add("button-disabled"),console.log("handleSubmission"),e.preventDefault();const t=document.getElementById("submitter-name").value,n=document.getElementById("memory-title").value,r=document.getElementById("memory-description").value,u=document.getElementById("memory-image").files[0],w=document.getElementById("email").value,o=document.getElementById("category").value,q=document.getElementById("link").value;let g=[];if(!u){alert("Please select an image to upload");return}if(o==="ux"||o==="web"?(m.style.display="block",p.required=!0):(m.style.display="none",p.required=!1),(o==="ux"||o==="web")&&!p.value&&g.push("Please provide a valid link (URL) for UX or Web category."),!a.checkValidity()){a.querySelectorAll(":invalid").forEach(y=>{g.push(`${y.name} is invalid.`)}),alert(`Error: 
`+g.join(`
`)),c.classList.remove("button-disabled");return}const A=this.getAttribute("data-attr-submit"),D=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),b=new FileReader;b.onloadend=function(v){const y=v.target.result,x={id:Date.now(),name:t,title:n,description:r,imageUrl:y,timestamp:new Date().getTime()},l=new FormData;l.append("name",t),l.append("design_title",n),l.append("design_description",r),l.append("image",u),l.append("email",w),l.append("link",q),l.append("design_category",o),fetch(A,{method:"POST",headers:{"X-CSRF-TOKEN":D},body:l}).then(i=>i.ok?i.json():i.json().then(s=>{let f="";for(const[H,C]of Object.entries(s.errors))C.forEach(F=>{f+=F+`
`});throw console.error("Error details:",s),new Error(f)})).then(i=>{if(i.success){a.reset(),L();const s=X(x);U.insertAdjacentElement("afterbegin",s),alert("Your design has been added to the time capsule!")}c.classList.remove("button-disabled")}).catch(i=>{c.classList.remove("button-disabled"),alert(`Error: occurred Submitting Design.
`+i)})},b.readAsDataURL(u)}function X(e){const t=document.createElement("div");return t.className="gallery-item",t.dataset.id=e.id,t.innerHTML=`
        <div class="gallery-image-container">
            <img src="${e.imageUrl}" alt="${e.title}" class="gallery-image">
        </div>
        <div class="gallery-info">
            <h3 class="gallery-title">${e.title}</h3>
            <p class="gallery-submitter">By ${e.name}</p>
            <p class="gallery-description">${e.description}</p>
        </div>
    `,t.addEventListener("click",()=>{S(e)}),t}function S(e){$.src=e.imageUrl,j.textContent=e.title,R.textContent=`Submitted by ${e.name}`,T.textContent=e.description,d.style.display="block"}G();const z=document.querySelectorAll(".gallery-item");z.forEach(e=>{e.addEventListener("click",t=>{let n={imageUrl:e.querySelector(".gallery-image").src,title:e.querySelector(".gallery-title").textContent,name:e.querySelector(".gallery-submitter").textContent.substring(3),description:e.querySelector(".gallery-description").textContent};S(n)})});document.getElementById("category").addEventListener("change",k);document.addEventListener("DOMContentLoaded",function(){k(),a.reset()});
